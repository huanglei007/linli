(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/shopDetail"],{"34ea":function(t,e,i){"use strict";(function(t){i("56c5"),i("33db");o(i("66fd"));var e=o(i("a048"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=i,t(e.default)}).call(this,i("543d")["createPage"])},4103:function(t,e,i){"use strict";var o;i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return o}));var n=function(){var t=this,e=t.$createElement,i=(t._self._c,t.Img(t.info.shop_logo)),o=t.__map(t.welfareList,(function(e,i){var o=t.__get_orig(e),n=i<2?e.name.split(" "):null;return{$orig:o,g0:n}})),n=t.__map(t.List,(function(e,i){var o=t.__get_orig(e),n=e.name?t.Img(e.images.split(",")[0]):null,r=e.name?t.Img(e.images):null;return{$orig:o,m1:n,m2:r}})),r=t.__map(t.welfareList,(function(e,i){var o=t.__get_orig(e),n=t.$shijiandate(e.begin_time),r=t.$shijiandate(e.expiration_time);return{$orig:o,m3:n,m4:r}})),a=t.sumPrice.toFixed(2),s=t.sumPrice.toFixed(2);t.$mp.data=Object.assign({},{$root:{m0:i,l0:o,l1:n,l2:r,g1:a,g2:s}})},r=[]},"8af2":function(t,e,i){"use strict";var o=i("ad7d"),n=i.n(o);n.a},a048:function(t,e,i){"use strict";i.r(e);var o=i("4103"),n=i("b85b");for(var r in n)"default"!==r&&function(t){i.d(e,t,(function(){return n[t]}))}(r);i("8af2");var a,s=i("f0c5"),u=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);e["default"]=u.exports},a7db:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(i("62c0"));function n(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return n=function(){return t},t}function r(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=n();if(e&&e.has(t))return e.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=o?Object.getOwnPropertyDescriptor(t,r):null;a&&(a.get||a.set)?Object.defineProperty(i,r,a):i[r]=t[r]}return i.default=t,e&&e.set(t,i),i}var a={data:function(){return{imageurl:"",htosp:0,userId:"",typeList:["商品","商家信息","在线福利"],typeIndex:0,bottomTop:0,isBottom:!1,List:[],ListIndex:0,categoryVos:[],welfareList:[],info:{},getPro:new Map,sumPrice:0,id:0,onoff:!0}},onShareAppMessage:function(t){return"button"===t.from&&console.log(t.target),{title:this.info.shop_name,path:"pages/index/shopDetail?id="+this.info.shop_id,mpId:"wx6ae9f157d9b35d24",imageUrl:this.info.shop_logo}},onShareTimeline:function(t){return{title:this.info.shop_name,type:0,summary:"",imageUrl:this.info.shop_logo}},onLoad:function(e){if(this.htosp=t.getStorageSync("htop"),this.userId=t.getStorageSync("userId"),this.imageurl=this.globalData.imageurl,e.id){this.id=e.id;var i=this;this.util.ajax("shop/shopProductDetail",{shopId:e.id,userId:this.userId},(function(t){i.categoryVos=t.data.categoryVos,i.categoryVos.length>0&&(i.List=t.data.categoryVos[0].productVos),i.ListIndex=0,i.info=t.data.info,i.welfareList=t.data.welfareList}))}},onPageScroll:function(t){t.scrollTop<this.bottomTop-10&&(this.isBottom=!1),this.isBottom&&(this.bottomTop=t.scrollTop)},onReachBottom:function(){this.isBottom=!0},methods:{phone:function(e){t.makePhoneCall({phoneNumber:e})},getwel:function(e){var i=this;if(!e.received){var o=this;this.util.ajax("userWelfare/receiveWelfare",{userId:this.userId,welfare_id:e.id,welfare_type:e.welfare_type},(function(n){if(2==e.welfare_type)i.$alert("领取成功"),e.received=1;else if(1==e.welfare_type){t.showLoading({title:""});var r=4;o.util.ajax("pay/toPay",{orderId:n.data.orderId,orderNum:n.data.orderNum,payType:1,paymentType:r,purpose:3,subject:"购买代金券",userId:o.userId},(function(i){t.hideLoading(),t.requestPayment({provider:"wxpay",timeStamp:i.data.timeStamp,nonceStr:i.data.nonceStr,package:i.data.packageValue,signType:"MD5",paySign:i.data.paySign,success:function(t){o.$alert("支付成功"),setTimeout((function(){e.received=1}),1e3)},fail:function(t){o.remark=t,o.$alert("支付失败"),o.loadmore()}})}))}}))}},doBusiness:function(e){var i=e.split(",");t.previewImage({current:i[0],urls:i})},collect:function(){var t=this;this.util.ajax("collection/addCollect",{infoId:this.id,type:1,userId:this.userId},(function(e){t.$alert(e.msg),t.info.collected=!t.info.collected}))},getsum:function(){var t=0;this.getPro.forEach((function(e){t+=e.count*e.selling_price})),this.sumPrice=t},changeType:function(t){this.typeIndex=t.detail.current},test:function(t){this.typeIndex=t},addPro:function(t){var e=this.List[t];e.count?e.count++:e.count=1,this.getPro.set(this.List[t].id,e),this.getsum(),this.$forceUpdate()},reduce:function(t){this.List[t].count&&(this.List[t].count--,0==this.List[t].count?this.getPro.delete(this.List[t].id):this.getPro.set(this.List[t].id,this.List[t]),this.getsum(),this.$forceUpdate())},changeList:function(t){this.ListIndex=t;for(var e=this.categoryVos[t].productVos,i=0;i<e.length;i++)this.getPro.has(e[i].id)&&(e[i].count=this.getPro.get(e[i].id).count);this.List=e},onShare:function(){var t={shareUrl:"pages/index/shopDetail?id="+this.info.shop_id,shareTitle:this.info.shop_name,shareContent:this.info.address,shareImg:this.Img(this.info.shop_logo),appId:"wx6ae9f157d9b35d24",appPath:"pages/index/shopDetail?id="+this.info.shop_id},e=(0,o.default)(t,(function(t){console.log("分享成功回调",t),(0,o.closeShare)()}));setTimeout((function(){e.close()}),5e3)},orderto:function(){var t=[],e=this;if(e.getPro.forEach((function(e){t.push({count:e.count,proId:e.id})})),0!=t.length){var i=JSON.stringify({productList:t,shopId:e.id,userId:e.userId});setTimeout((function(){e.info.delivery_fee&&e.sumPrice.toFixed(2)<e.info.initial_delivery_fee?e.$jump("./shopOrder?id="+e.id+"&index="+i+"&delivery_fee="+e.info.delivery_fee):e.$jump("./shopOrder?id="+e.id+"&index="+i)}),500)}else e.$alert("请选择商品")}}};e.default=a}).call(this,i("543d")["default"])},ad7d:function(t,e,i){},b85b:function(t,e,i){"use strict";i.r(e);var o=i("a7db"),n=i.n(o);for(var r in o)"default"!==r&&function(t){i.d(e,t,(function(){return o[t]}))}(r);e["default"]=n.a}},[["34ea","common/runtime","common/vendor"]]]);