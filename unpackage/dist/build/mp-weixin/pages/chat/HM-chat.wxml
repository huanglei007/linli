<view><view class="baidi"><view class="toptype flexd jubetween" style="{{'padding-top:'+(htosp+'rpx')+';'}}"><image class="backs" src="/static/image/icon_gb.png" mode data-event-opts="{{[['tap',[['$jumpback']]]]}}" bindtap="__e"></image><view class="titla texcenter">{{tita}}</view></view></view><view data-event-opts="{{[['touchstart',[['hideDrawer',['$event']]]]]}}" class="content" bindtouchstart="__e"><scroll-view class="{{['msg-list',popupLayerClass]}}" style="{{(keepkond)}}" scroll-y="true" scroll-with-animation="{{scrollAnimation}}" scroll-top="{{scrollTop}}" scroll-into-view="{{scrollToView}}" upper-threshold="50" data-event-opts="{{[['scrolltoupper',[['loadHistory',['$event']]]]]}}" bindscrolltoupper="__e"><view class="loading"><view class="spinner"><view class="rect1"></view><view class="rect2"></view><view class="rect3"></view><view class="rect4"></view><view class="rect5"></view></view></view><block wx:for="{{$root.l0}}" wx:for-item="row" wx:for-index="index" wx:key="index"><view class="row" id="{{'msg'+row.$orig.msg.id}}"><block wx:if="{{row.$orig.type=='system'}}"><block><view class="system"><block wx:if="{{row.$orig.msg.type=='text'}}"><view class="text">{{''+row.$orig.msg.content.text+''}}</view></block><block wx:if="{{row.$orig.msg.type=='redEnvelope'}}"><view class="red-envelope"><image src="/static/img/red-envelope-chat.png"></image>{{''+row.$orig.msg.content.text+''}}</view></block></view></block></block><block wx:if="{{row.$orig.type=='user'}}"><block><block wx:if="{{row.$orig.msg.userinfo.uid==myuid}}"><view class="my"><view class="time texcenter">{{row.m0}}</view><view class="flexd" style="justify-content:flex-end;"><view class="left"><block wx:if="{{row.$orig.msg.type=='text'}}"><view class="bubble"><rich-text nodes="{{row.$orig.msg.content.text}}"></rich-text></view></block><block wx:if="{{row.$orig.msg.type=='img'}}"><view data-event-opts="{{[['tap',[['showPic',['$0'],[[['msgList','',index,'msg.content.url']]]]]]]}}" class="bubble img" bindtap="__e"><image style="{{'width:'+(row.$orig.msg.content.w+'px')+';'+('height:'+(row.$orig.msg.content.h+'px')+';')}}" mode="aspectFill" src="{{imageurl+row.$orig.msg.content.url}}"></image></view></block></view><view class="right"><image src="{{imageurl+row.$orig.msg.userinfo.face}}"></image></view></view></view></block><block wx:if="{{row.$orig.msg.userinfo.uid!=myuid}}"><view class="other"><view class="time texcenter">{{row.m1}}</view><view class="flexd"><view class="left"><image src="{{imageurl+row.$orig.msg.userinfo.face}}"></image></view><view class="right"><block wx:if="{{row.$orig.msg.type=='text'}}"><view class="bubble"><rich-text nodes="{{row.$orig.msg.content.text}}"></rich-text></view></block><block wx:if="{{row.$orig.msg.type=='img'}}"><view data-event-opts="{{[['tap',[['showPic',['$0'],[[['msgList','',index,'msg.content.url']]]]]]]}}" class="bubble img" bindtap="__e"><image style="{{'width:'+(row.$orig.msg.content.w+'px')+';'+('height:'+(row.$orig.msg.content.h+'px')+';')}}" mode="aspectFill" src="{{imageurl+row.$orig.msg.content.url}}"></image></view></block></view></view></view></block></block></block></view></block></scroll-view></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="{{['popup-layer',popupLayerClass]}}" catchtouchmove="__e"><swiper class="{{['emoji-swiper',(hideEmoji)?'hidden':'']}}" indicator-dots="true" duration="150"><block wx:for="{{emojiList}}" wx:for-item="page" wx:for-index="pid" wx:key="pid"><swiper-item><block wx:for="{{page}}" wx:for-item="em" wx:for-index="eid" wx:key="eid"><view data-event-opts="{{[['tap',[['addEmoji',['$0'],[[['emojiList','',pid],['','',eid]]]]]]]}}" bindtap="__e"><block wx:if="{{imageurl}}"><block><image mode="widthFix" src="{{imageurl+'static/img/emoji2/'+em.url}}"></image></block></block></view></block></swiper-item></block></swiper><view class="{{['more-layer',(hideMore)?'hidden':'']}}"><view class="list"><view data-event-opts="{{[['tap',[['chooseImage',['$event']]]]]}}" class="box" bindtap="__e"><image src="/static/HM-chat/img_xc.png" mode></image><view class="texcenter">相册</view></view><view data-event-opts="{{[['tap',[['camera',['$event']]]]]}}" class="box" bindtap="__e"><image src="/static/HM-chat/img_ps.png" mode></image><view class="texcenter">拍照</view></view><view data-event-opts="{{[['tap',[['$callphone',['$0'],['toUserPhone']]]]]}}" class="box" bindtap="__e"><image src="/static/HM-chat/phone.jpg" mode></image><view class="texcenter">电话</view></view></view></view></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="{{['input-box',popupLayerClass]}}" style="{{'bottom:'+(keyHeight+'%')+';'}}" catchtouchmove="__e"><view class="textbox"><view class="text-mode"><view class="box"><textarea auto-height="true" adjust-position="{{false}}" auto-blur="{{true}}" show-confirm-bar="{{false}}" cursor-spacing="{{20}}" data-event-opts="{{[['blur',[['e0',['$event']]]],['tap',[['textareaClick',['$event']]]],['input',[['__set_model',['','textMsg','$event',[]]]]]]}}" value="{{textMsg}}" bindblur="__e" bindtap="__e" bindinput="__e"></textarea></view></view></view><view data-event-opts="{{[['tap',[['chooseEmoji',['$event']]]]]}}" class="em" bindtap="__e"><view class="icon biaoqing"></view></view><view data-event-opts="{{[['tap',[['showMore',['$event']]]]]}}" class="more" bindtap="__e"><view class="icon add"></view></view><view data-event-opts="{{[['tap',[['sendText',['$event']]]]]}}" class="{{['send',isVoice?'hidden':'']}}" bindtap="__e"><view class="btn">发送</view></view></view></view>