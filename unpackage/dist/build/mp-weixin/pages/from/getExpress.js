(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/from/getExpress"],{5259:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){i.e("components/timeRange").then(function(){return resolve(i("1e08"))}.bind(null,i)).catch(i.oe)},n=function(){i.e("components/changeAddresss").then(function(){return resolve(i("0e9b"))}.bind(null,i)).catch(i.oe)},o={components:{pickerAddress:n,timePicker:a},props:["list"],data:function(){this.getDate({format:!0});return{htosp:0,name:"",time:"12:01",buyAdd:{},sentAdd:{},addIndex:"buyAdd",isAddress:!1,phone:"",imageValue:[],startTimeShow:!1,takeParts:[{commission:0,id:0,number:"请选择取件数量"}],take_index:0,formdata:{categoryId:1,publisherName:"",publisherSex:0,leaveMessage:"",publisherPhone:"",delivery_date:"",deliveryStartTime:"",deliveryEndTime:"",now_delivery:0},disalbe:!1,couponform:{},couponlist:[],commission:0,radio_time:0,arr_time:[{text:"两小时内",value:"0"},{text:"立即配送",value:"1"}],onoff:!0}},mounted:function(t){this.htosp=e.getStorageSync("htop"),this.userId=e.getStorageSync("userId"),this.formdata.deliveryStartTime=this.$shijianhour((new Date).getTime()),this.formdata.deliveryEndTime=this.$shijianhour((new Date).getTime()+72e5),this.formdata.delivery_date=this.$shijian(new Date).split(" ")[0];var i=this;this.util.ajax("release/getExpressNumberList",{},(function(e){i.takeParts=i.takeParts.concat(e.data.list),i.couponform.amount||(i.commission=i.takeParts[i.take_index].commission)}))},watch:{list:function(e,t){var i=this;e.length>0&&setTimeout((function(){i.screenEvent(e)}),1e3)},radio_time:function(e,t){var i=this;1==e?i.commission+=1:i.commission-=1},commission:function(e,t){this.commission=Number(e.toFixed(2))}},methods:{cancel:function(){this.isAddress=!1},getAdd:function(e){this[this.addIndex]=e},bindTimeChange:function(e){},change:function(e){this.address=e,this.txt=e.data.join("-")},changeAdd:function(e){this[this.addIndex]=e,this.isAddress=!1},getDate:function(e){var t=new Date,i=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();return"start"===e?i-=60:"end"===e&&(i+=2),a=a>9?a:"0"+a,n=n>9?n:"0"+n,"".concat(i,"-").concat(a,"-").concat(n)},addImg:function(){this.util.sendimage(5-this.imageValue.length,this.imageValue)},del:function(e){this.imageValue.splice(e,1)},bindPickerChange:function(e){var t=this;t.take_index=e.target.value,this.screenEvent(t.list),0==t.radio_time?t.couponform.amount?t.commission=t.takeParts[e.target.value].commission-t.couponform.amount:t.commission=t.takeParts[e.target.value].commission:t.couponform.amount?t.commission=t.takeParts[e.target.value].commission+1-t.couponform.amount:t.commission=t.takeParts[e.target.value].commission+1},radioChange:function(e){for(var t=this,i=0;i<t.arr_time.length;i++)t.arr_time[i].value==e.detail.value&&(t.radio_time=i,t.formdata.now_delivery=i)},screenEvent:function(e){var t=this,i=t.takeParts[t.take_index].commission;t.couponlist=[];for(var a=0;a<e.length;a++)i>=e[a].min_order_amount&&0==e[a].use_status&&t.couponlist.push(e[a])},selectEvent:function(){var t=this;if(t.couponlist.length>0){var i=t.takeParts[t.take_index],a="?price="+i.commission;t.couponform.amount&&(a=a+"&coup_id="+t.couponform.id),e.navigateTo({url:"/pagesA/a_myWelfare"+a,events:{acceptDataFromOpenedPage:function(e){0==t.radio_time?e.data?(t.couponform=e.data,t.commission=i.commission-e.data.amount):(t.couponform={},t.commission=i.commission):e.data?(t.couponform=e.data,t.commission=i.commission+1-e.data.amount):(t.couponform={},t.commission=i.commission+1)}}})}},submit:function(){if(!this.disable){if(this.disable=!0,!this.buyAdd.address)return this.$alert("请选择取件地址"),void(this.disable=!1);if(!this.sentAdd.address)return this.$alert("请选择送货地址"),void(this.disable=!1);if(0==this.take_index)return this.$alert("请选择取件数量"),void(this.disable=!1);if(!this.imageValue.length)return this.$alert("请上传快递取件码截图"),void(this.disable=!1);var t=this;this.$refs.form.validate().then((function(i){e.showLoading({title:""});var a=i;a.publisherName=t.sentAdd.name,a.publisherPhone=t.sentAdd.phone,a.categoryId=t.formdata.categoryId,a.publisherSex=t.formdata.publisherSex,a.leaveMessage=t.formdata.leaveMessage,a.numberId=t.takeParts[t.take_index].id,a.images=t.imageValue.join(),a.addressId=t.buyAdd.id,a.addressId2=t.sentAdd.id,a.commission=t.commission,a.couponId=t.couponform.id,a.userId=t.userId,a.delivery_date=t.formdata.delivery_date,a.deliveryStartTime=t.formdata.deliveryStartTime,a.deliveryEndTime=t.formdata.deliveryEndTime,a.now_delivery=t.formdata.now_delivery,t.util.ajax("release/saveRelease",a,(function(i){var a=4;t.util.ajax("pay/toPay",{orderId:i.data.id,orderNum:i.data.orderNum,payType:1,paymentType:a,purpose:2,subject:"发布需求",userId:t.userId},(function(i){e.hideLoading(),e.requestPayment({provider:"wxpay",timeStamp:i.data.timeStamp,nonceStr:i.data.nonceStr,package:i.data.packageValue,signType:"MD5",paySign:i.data.paySign,success:function(e){t.$alert("支付成功"),t.disable=!1,setTimeout((function(){t.$jump("/pages/user/myOrder/myOrder?type=0")}),1e3)},fail:function(e){t.remark=e,t.$alert("支付失败"),t.disable=!1}})}))}))})).catch((function(e){t.disable=!1}))}},refresh:function(){this.isAddress&&this.$refs.add.refresh()}}};t.default=o}).call(this,i("543d")["default"])},"888b":function(e,t,i){"use strict";var a=i("a97c"),n=i.n(a);n.a},"913f":function(e,t,i){"use strict";i.r(t);var a=i("5259"),n=i.n(a);for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a},a97c:function(e,t,i){},daeb:function(e,t,i){"use strict";i.r(t);var a=i("ec2d"),n=i("913f");for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("888b");var s,r=i("f0c5"),d=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],s);t["default"]=d.exports},ec2d:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return a}));var a={uniForms:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(i.bind(null,"5680"))}},n=function(){var e=this,t=e.$createElement,i=(e._self._c,e.__map(e.imageValue,(function(t,i){var a=e.__get_orig(t),n=e.Img(t);return{$orig:a,m0:n}})));e._isMounted||(e.e0=function(t){e.addIndex="buyAdd",e.isAddress=!0},e.e1=function(t){e.addIndex="sentAdd",e.isAddress=!0}),e.$mp.data=Object.assign({},{$root:{l0:i}})},o=[]}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/from/getExpress-create-component',
    {
        'pages/from/getExpress-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("daeb"))
        })
    },
    [['pages/from/getExpress-create-component']]
]);
