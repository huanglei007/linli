(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/from/food"],{"05b2":function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}));var n={uniForms:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(i.bind(null,"d623"))}},o=function(){var e=this,t=e.$createElement,i=(e._self._c,e.__map(e.imageValue,(function(t,i){var n=e.__get_orig(t),o=e.Img(t);return{$orig:n,m0:o}})));e._isMounted||(e.e0=function(t){e.addIndex="buyAdd",e.isAddress=!0},e.e1=function(t){e.addIndex="sentAdd",e.isAddress=!0}),e.$mp.data=Object.assign({},{$root:{l0:i}})},a=[]},"0623":function(e,t,i){"use strict";var n=i("d19e"),o=i.n(n);o.a},"44a6":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){i.e("components/timeRange").then(function(){return resolve(i("a43a"))}.bind(null,i)).catch(i.oe)},o=function(){i.e("components/changeAddresss").then(function(){return resolve(i("0f15"))}.bind(null,i)).catch(i.oe)},a={components:{pickerAddress:o,timePicker:n},props:["list"],data:function(){this.getDate({format:!0});return{htosp:0,name:"",time:"12:01",buyAdd:{},sentAdd:{},addIndex:"buyAdd",isAddress:!1,phone:"",imageValue:[],foodNum:[{commission:0,id:0,number:"请选择外卖数量"}],startTimeShow:!1,food_index:0,timeTxt:"立即配送",formdata:{categoryId:21,publisherName:"",publisherSex:0,leaveMessage:"",deliveryStartTime:"",deliveryEndTime:"",publisherPhone:"",delivery_date:"",now_delivery:1},disable:!1,couponform:{},couponlist:[],commission:0,onoff:!0}},mounted:function(t){this.htosp=e.getStorageSync("htop"),this.userId=e.getStorageSync("userId"),this.formdata.deliveryStartTime=this.$shijianhour((new Date).getTime()),this.formdata.deliveryEndTime=this.$shijianhour((new Date).getTime()+72e5),this.formdata.delivery_date=this.$shijian(new Date).split(" ")[0];var i=this;this.util.ajax("release/deliverTakeoutNumberList",{},(function(e){i.foodNum=i.foodNum.concat(e.data.list),i.couponform.amount||(i.commission=i.foodNum[i.food_index].commission)}))},watch:{list:function(e,t){var i=this;e.length>0&&setTimeout((function(){i.screenEvent(e)}),1e3)}},methods:{cancel:function(){this.isAddress=!1},bindPickerChange:function(e){var t=this;t.food_index=e.target.value,this.screenEvent(t.list),t.couponform.amount?t.commission=(t.foodNum[e.target.value].commission-t.couponform.amount).toFixed(2):t.commission=t.foodNum[e.target.value].commission},getAdd:function(e){this[this.addIndex]=e},bindTimeChange:function(e){},change:function(e){this.address=e,this.txt=e.data.join("-")},changeAdd:function(e){this[this.addIndex]=e,this.isAddress=!1},getDate:function(e){var t=new Date,i=t.getFullYear(),n=t.getMonth()+1,o=t.getDate();return"start"===e?i-=60:"end"===e&&(i+=2),n=n>9?n:"0"+n,o=o>9?o:"0"+o,"".concat(i,"-").concat(n,"-").concat(o)},addImg:function(){this.util.sendimage(5-this.imageValue.length,this.imageValue)},del:function(e){this.imageValue.splice(e,1)},radioChange:function(e){},screenEvent:function(e){var t=this;t.couponlist=[];for(var i=0;i<e.length;i++)t.foodNum[t.food_index].commission>=e[i].min_order_amount&&0==e[i].use_status&&t.couponlist.push(e[i])},selectEvent:function(){var t=this;if(t.couponlist.length>0){var i=t.foodNum[t.food_index],n="?price="+i.commission.toFixed(2);t.couponform.amount&&(n=n+"&coup_id="+t.couponform.id),e.navigateTo({url:"/pagesA/a_myWelfare"+n,events:{acceptDataFromOpenedPage:function(e){e.data?(t.couponform=e.data,t.commission=(i.commission-e.data.amount).toFixed(2)):(t.couponform={},t.commission=i.commission)}}})}},submit:function(){if(!this.disable){if(this.disable=!0,!this.buyAdd.address)return this.$alert("请选择取件地址"),void(this.disable=!1);if(!this.sentAdd.address)return this.$alert("请选择送货地址"),void(this.disable=!1);if(0==this.food_index)return this.$alert("请选择外卖数量"),void(this.disable=!1);if(!this.imageValue.length)return this.$alert("请上传外卖订单截图"),void(this.disable=!1);var t=this;this.$refs.form.validate().then((function(i){e.showLoading({title:""});var n=i;n.publisherName=t.sentAdd.name,n.publisherPhone=t.sentAdd.phone,n.categoryId=t.formdata.categoryId,n.publisherSex=t.formdata.publisherSex,n.leaveMessage=t.formdata.leaveMessage,n.numberId=t.foodNum[t.food_index].id,n.deliveryStartTime=t.formdata.deliveryStartTime,n.deliveryEndTime=t.formdata.deliveryEndTime,n.delivery_date=t.formdata.delivery_date,n.images=t.imageValue.join(),n.addressId=t.buyAdd.id,n.addressId2=t.sentAdd.id,n.commission=t.commission,n.now_delivery=t.formdata.now_delivery,n.couponId=t.couponform.id,n.userId=t.userId,t.util.ajax("release/saveRelease",n,(function(i){var n=4;t.util.ajax("pay/toPay",{orderId:i.data.id,orderNum:i.data.orderNum,payType:1,paymentType:n,purpose:2,subject:"发布需求",userId:t.userId},(function(i){e.hideLoading(),e.requestPayment({provider:"wxpay",timeStamp:i.data.timeStamp,nonceStr:i.data.nonceStr,package:i.data.packageValue,signType:"MD5",paySign:i.data.paySign,success:function(e){t.$alert("支付成功"),t.disable=!1,setTimeout((function(){t.$jump("/pages/user/myOrder/myOrder?type=0")}),1e3)},fail:function(e){t.remark=e,t.$alert("支付失败"),t.disable=!1}})}))}))})).catch((function(e){t.disable=!1}))}},refresh:function(){this.isAddress&&this.$refs.add.refresh()}}};t.default=a}).call(this,i("543d")["default"])},"61ab":function(e,t,i){"use strict";i.r(t);var n=i("44a6"),o=i.n(n);for(var a in n)"default"!==a&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a},d19e:function(e,t,i){},fb89:function(e,t,i){"use strict";i.r(t);var n=i("05b2"),o=i("61ab");for(var a in o)"default"!==a&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("0623");var s,d=i("f0c5"),r=Object(d["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=r.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/from/food-create-component',
    {
        'pages/from/food-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("fb89"))
        })
    },
    [['pages/from/food-create-component']]
]);
