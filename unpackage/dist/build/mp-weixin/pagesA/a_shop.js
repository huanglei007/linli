(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesA/a_shop"],{"0cea":function(t,e,a){"use strict";(function(t){a("56c5"),a("33db");i(a("66fd"));var e=i(a("4630"));function i(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=a,t(e.default)}).call(this,a("543d")["createPage"])},4630:function(t,e,a){"use strict";a.r(e);var i=a("973c"),n=a("9d20");for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("6cea");var s,u=a("f0c5"),r=Object(u["a"])(n["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);e["default"]=r.exports},"6cea":function(t,e,a){"use strict";var i=a("d40f"),n=a.n(i);n.a},"973c":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i}));var i={uniNumberBox:function(){return a.e("uni_modules/uni-number-box/components/uni-number-box/uni-number-box").then(a.bind(null,"be49"))}},n=function(){var t=this,e=t.$createElement,a=(t._self._c,t.form.shop_logo?null:t.Img(t.imageValue[0]));t._isMounted||(t.e0=function(e){t.hoursShow=!0},t.e1=function(e){t.hoursShow=!1},t.e2=function(e){t.hoursShow=!1}),t.$mp.data=Object.assign({},{$root:{m0:a}})},o=[]},"9d20":function(t,e,a){"use strict";a.r(e);var i=a("d0d5"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},d0d5:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={components:{},data:function(){return{imageurl:"",userId:"",form:{},imageValue:[],shopType:[{icon:"",id:0,name:"",parentId:0}],typeIndex:0,shopStatus:[{label:"休息",business_status:0},{label:"营业",business_status:1}],hoursShow:!1,businessHours:["开始时间","结束时间"],timeVal_start:[9,9],timeVal_end:[15,15],operation:[],operationIndex:0,deposit_index:0,deposit_arr:[{text:"不交押金",value:"0"},{text:"交押金",value:"1"}],deposit_array_index:0,deposit_array:[],onoff:!0}},onLoad:function(){this.getTypeList(),this.getOperation(),this.userId=t.getStorageSync("userId"),this.imageurl=this.globalData.imageurl},watch:{imageValue:function(t,e){this.form.shop_logo=this.Img(t[0])}},methods:{getTypeList:function(){var t=this;this.util.ajax("shop/getShopTypeList",{parentId:0,secondType:1},(function(e){t.shopType=e.data.list,t.getMyShop()}))},getMyShop:function(){var t=this,e=this;this.util.ajax("shop/getShopInfo",{userId:e.userId},(function(a){for(var i in e.form=a.data,a.data.deposit_amount>0&&(e.deposit_index="1",t.util.ajax("shop/queryShopDepositSet",{},(function(t){e.deposit_array=t.data.list;for(var a=0;a<t.data.list.length;a++)e.form.deposit_amount==t.data.list[a].amount&&(e.deposit_array_index=a)}))),e.operation)e.operation[i].id==a.data.operation_point_id&&(e.operationIndex=i)}))},saveEvent:function(){var e=this,a=this;this.util.ajax("shop/saveShopSet",a.form,(function(i){"1"==a.deposit_index&&0==a.form.deposit_amount?e.util.ajax("shop/submitShopDepositOrder",{amount:a.deposit_array[a.deposit_array_index].amount,userId:a.userId},(function(e){var i=4;a.util.ajax("pay/toPay",{orderNum:e.data.order_num,payType:1,paymentType:i,purpose:5,subject:"押金",userId:a.userId},(function(e){t.hideLoading(),t.requestPayment({provider:"wxpay",timeStamp:e.data.timeStamp,nonceStr:e.data.nonceStr,package:e.data.packageValue,signType:"MD5",paySign:e.data.paySign,success:function(t){a.$alert("提交成功"),setTimeout((function(){a.$jumpback()}),1e3)},fail:function(t){a.$alert("支付失败")}})}))})):(e.$alert("保存成功"),setTimeout((function(){a.$jumpback()}),1e3))}))},getOperation:function(){var t=this;this.util.ajax("common/operationPointList",{},(function(e){t.operation=e.data.list}))},shopTypeChange:function(t){var e=this;e.typeIndex=t.detail.value},shopStatusChange:function(t){var e=this,a=this;a.form.business_status=a.shopStatus[t.detail.value].business_status,this.util.ajax("shop/editShopStatus",{business_status:a.shopStatus[t.detail.value].business_status,user_id:a.userId},(function(t){e.$alert("营业状态已保存")}))},operationChange:function(t){var e=this;e.operationIndex=t.detail.value,e.form.operation_point_id=t.detail.operation_point_id},bindChange_start:function(t){var e=this;e.timeVal_start=t.detail.value},bindChange_end:function(t){var e=this;e.timeVal_end=t.detail.value},radioChange:function(t){var e=this;e.deposit_index=t.detail.value,"1"==t.detail.value&&this.util.ajax("shop/queryShopDepositSet",{},(function(t){e.deposit_array=t.data.list}))},depositChange:function(t){console.log(t),this.deposit_array_index=t.detail.value},returnDeposit:function(){var e=this;t.showModal({title:"",content:"确认退还押金吗?",success:function(t){t.confirm?e.util.ajax("shop/submitShopDepositRefund",{amount:e.form.deposit_amount,userId:e.form.user_id},(function(t){e.$alert("已提交申请，请等待审核")})):t.cancel&&console.log("用户点击取消")}})},confirmEvent:function(){for(var t=this,e="",a="",i="",n="",o=0;o<t.timeVal_start.length;o++)t.timeVal_start[o]<10?0==o?e="0"+t.timeVal_start[o]:a="0"+t.timeVal_start[o]:0==o?e=t.timeVal_start[o]:a=t.timeVal_start[o];for(var s=0;s<t.timeVal_end.length;s++)t.timeVal_end[s]<10?0==s?i="0"+t.timeVal_start[s]:n="0"+t.timeVal_start[s]:0==s?i=t.timeVal_end[s]:n=t.timeVal_end[s];t.form.service_begin_time=e+":"+a,t.form.service_end_time=i+":"+n,this.hoursShow=!1},updateImg:function(){this.util.sendimage(5-this.imageValue.length,this.imageValue)},doBusiness:function(){var e=this,a=this.form.business_license,i=[];i.push(e.imageurl+a),t.previewImage({current:i[0],urls:i})}}};e.default=a}).call(this,a("543d")["default"])},d40f:function(t,e,a){}},[["0cea","common/runtime","common/vendor"]]]);